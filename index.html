<!DOCTYPE html>
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
	    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
	    <title>AugmentedReality aFrame.js Litto</title>

	    <style>
			@import url('https://fonts.googleapis.com/css?family=Ubuntu&display=swap" rel="stylesheet');

			#figure {
			  right: 0;
			  float: left;
			  margin: 10px 10px;
			  background: transparent;
			  font-family: 'Ubuntu', sans-serif;
			  position: fixed;
			  top: 100px;
			  right: 100px;
			  margin: 0 10px 10px 0;
			  z-index: 1000;
			}

			</style>
	    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
	    <!-- we import arjs version without NFT but with marker + location based support -->
	    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
	    <!-- shape key modifyer -->
	    <script src="https://rawcdn.githack.com/elbobo/aframe-gltf-morph-component/07e9b80bd382cc1c19223468d35c453e7c76e9a2/dist/aframe-gltf-morph-component.js"></script>

    	<!--to animate gltf files see also: https://aframe.io/docs/1.0.0/components/gltf-model.html-->
    	<script src="https://raw.githubusercontent.com/donmccurdy/aframe-extras/master/src/loaders/animation-mixer.js" ></script>

    	<script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    	<!--for older versions of gltf files --> 
    	<script src="https://github.com/donmccurdy/aframe-extras/blob/master/src/loaders/gltf-model-legacy.js"></script>
    	<script src="js/scrape.js"></script>

    	<script> 
			 AFRAME.registerComponent('material-displacement', {
			  /**
			   * Creates a new THREE.ShaderMaterial using the two shaders defined
			   * in vertex.glsl and fragment.glsl.
			   */
			  init: function () {
			    this.material  = new THREE.ShaderMaterial({
			      uniforms: {time: { value: 0.0 }},
			      vertexShader,
			      fragmentShader
			    });
			    this.el.addEventListener('model-loaded', () => this.update());
			  },

			  /**
			   * Apply the material to the current entity.
			   */
			  update: function () {
			    const mesh = this.el.getObject3D('mesh');
			    if (mesh) {
			      mesh.material = this.material;
			    }
			  },

			  /**
			   * On each frame, update the 'time' uniform in the shaders.
			   */
			  tick: function (t) {
			    this.material.uniforms.time.value = t / 1000;
			  }
			  
			})
		</script>

	</head>
    <body style="margin : 0px; overflow: hidden;">

        <a-scene embedded arjs='sourceType: webcam; detectionMode: mono_and_matrix; matrixCodeType: 3x3; labelingMode: white_region;' renderer='precision: medium;'>
		    <a-assets>
         		<img id="deathSphere" src="assets/deathSphere.png">
        	</a-assets>
	        <a-marker id='marker_sh' registerevents preset='custom' type='pattern' url='stayhome2.patt'>

		        <a-sphere 
		        material-displacement
		        radius: 0.2
		        material="src: #deathSphere; side: double; depthTest: false; transparent: true"
		        position="0 0 0.5"
		        displacement-map="#deathSphere"
		        animation__rotate="property: rotation; dur: 8000; easing: linear; dir: normal; from:0 0 0; to: 0 360 0; loop: true;"
		        animation__scale="property: scale; direction:alternate-reverse; dur:5000; from:1 1 1; to:4 4 4: loop: true;"
		        ></a-sphere>

		        <a-sphere 
		        radius: 0.5
		        material="src: #deathSphere; side: double; depthTest: false; transparent: true"
		        scale="0.5 0.5 0.5"
		        position="0 0 0.5"
		        animation="property: rotation; dur: 8000; easing: linear; dir: normal; from:0 0 0; to: 0 -360 0; loop: true;"

		        ></a-sphere>

			</a-marker>

        	<a-entity camera></a-entity>
        </a-scene>

        <div id="figure"></div>


    </body>
</html>


      
